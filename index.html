<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LIMIT BREAKER: NEO-EVO</title>
    <!-- 모바일 앱 설치 최적화 메타 태그 -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#020617">
    
    <!-- 1. React & ReactDOM (Stable Core) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 2. Babel (JSX Compiler) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 3. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 4. Lucide Icons (Browser version) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,400;0,900;1,900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #020617; 
            color: white; 
            margin: 0; 
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.15; }
            50% { opacity: 0.3; }
        }
        .animate-pulse-glow { animation: pulse-glow 4s ease-in-out infinite; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        
        .calendar-cell {
            aspect-ratio: 1 / 1.1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        @media (max-width: 320px) {
            .text-xs { font-size: 0.65rem; }
            .text-sm { font-size: 0.75rem; }
        }

        .toast-active { transform: translateY(0); opacity: 1; transition: all 0.3s ease; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- Lucide Icon Wrapper for React ---
        const LucideIcon = ({ name, size = 20, className = "" }) => {
            const containerRef = useRef(null);

            useEffect(() => {
                if (containerRef.current && window.lucide) {
                    containerRef.current.innerHTML = ''; 
                    const iconElement = document.createElement('i');
                    iconElement.setAttribute('data-lucide', name);
                    if (size) iconElement.style.width = `${size}px`;
                    if (size) iconElement.style.height = `${size}px`;
                    if (className) iconElement.className = className;
                    containerRef.current.appendChild(iconElement);
                    window.lucide.createIcons({
                        attrs: { strokeWidth: 2.5 }
                    });
                }
            }, [name, size, className]);

            return <span ref={containerRef} className="inline-flex items-center justify-center" />;
        };

        const BoxingGloveIcon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                <path d="M14 10V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                <path d="M18 8a4 4 0 0 1 4 4v3a6 6 0 0 1-6 6H8a6 6 0 0 1-6-6v-3a4 4 0 0 1 4-4h12Z" />
                <path d="M6 12h12" />
            </svg>
        );

        const ROUTINES = [
            { id: 'day1', label: "D1", name: "하체 파워 보강", detail: "링피트 하체 + 피박3 고강도", color: "from-blue-600 to-indigo-700", glow: "text-blue-400", synergy: "하체 소진 후 체지방 연소 극대화" },
            { id: 'day2', label: "D2", name: "순수 심폐 폭격", detail: "피트니스 복싱 3 고강도 단독", color: "from-cyan-400 to-blue-500", glow: "text-cyan-300", synergy: "관절 관리 및 유산소 효과 정점" },
            { id: 'day3', label: "D3", name: "코어 & 밸런스", detail: "링피트 코어/등 + 피박3 고강도", color: "from-orange-500 to-red-600", glow: "text-orange-400", synergy: "자세 교정 및 펀치 안정성 확보" },
            { id: 'rest', label: "EVO", name: "초회복 페이즈", detail: "신체 기능 업그레이드", color: "from-emerald-500 to-teal-600", glow: "text-emerald-400", synergy: "성장을 위한 필수 골든타임" },
            { id: 'off', label: "OFF", name: "일반 휴식", detail: "별도의 일정 없는 완전 정지", color: "from-slate-600 to-slate-800", glow: "text-slate-400", synergy: "부족한 수면과 에너지를 보충하는 중립 상태" },
        ];

        const COMPLETION_TYPES = [
            { id: 'full', label: 'FULL', icon: "award", miniIcon: "award", color: 'bg-yellow-500' },
            { id: 'ringfit', label: 'RING', icon: "target", miniIcon: "target", color: 'bg-orange-500' },
            { id: 'boxing', label: 'BOX', icon: "activity", miniIcon: "activity", color: 'bg-blue-500' },
        ];

        const MOTIVATION_QUOTES = [
            "어제보다 나은 오늘이 당신을 위대하게 만든다.",
            "한계는 당신의 마음이 결정하는 허상일 뿐이다.",
            "근육은 가장 정직한 예술이다.",
            "지금의 고통은 미래의 감사장이다.",
            "멈추지 마라. 당신은 이미 강해지고 있다.",
            "변명은 칼로리를 태우지 못한다.",
            "완벽보다 딱 1%만 더 나아가라.",
            "고통은 잠시, 후회는 영원하다.",
            "엔진은 아직 식지 않았다. 다시 점화하라.",
            "초회복 중, 신체는 지금 진화하고 있다.",
            "승자는 한 번 더 시도한 패자일 뿐.",
            "땀방울은 당신이 살아있다는 뜨거운 증거.",
            "운동은 나를 사랑하는 적극적인 방법.",
            "오늘 하지 않으면 내일의 당신이 고생한다."
        ];

        function App() {
            const [logs, setLogs] = useState({});
            const [viewMode, setViewMode] = useState('calendar'); 
            const [viewDate, setViewDate] = useState(new Date());
            const [selectedDate, setSelectedDate] = useState(new Date());
            const [showNavModal, setShowNavModal] = useState(false);
            const [tempNote, setTempNote] = useState("");
            const [toast, setToast] = useState(null);
            const fileInputRef = useRef(null);

            useEffect(() => {
                const saved = localStorage.getItem('workout_logs_mobile_v4_off');
                if (saved) setLogs(JSON.parse(saved));
            }, []);

            useEffect(() => {
                const dateStr = formatDate(selectedDate);
                setTempNote(logs[dateStr]?.note || "");
            }, [selectedDate, logs]);

            const showMessage = (msg) => {
                setToast(msg);
                setTimeout(() => setToast(null), 3000);
            };

            const yearLogsCount = useMemo(() => {
                const yearStr = viewDate.getFullYear().toString();
                return Object.keys(logs).filter(d => d.startsWith(yearStr) && logs[d].programId !== 'off').length;
            }, [logs, viewDate]);

            const currentQuote = useMemo(() => {
                const day = selectedDate.getDate();
                const month = selectedDate.getMonth();
                return MOTIVATION_QUOTES[(day + month) % MOTIVATION_QUOTES.length];
            }, [selectedDate]);

            const saveLog = (dateStr, programId, status = 'full', note = null) => {
                const existing = logs[dateStr] || {};
                const newLogs = { 
                    ...logs, 
                    [dateStr]: { 
                        ...existing,
                        programId, 
                        status, 
                        note: note !== null ? note : (existing.note || ""),
                        updatedAt: new Date().toISOString() 
                    } 
                };
                setLogs(newLogs);
                localStorage.setItem('workout_logs_mobile_v4_off', JSON.stringify(newLogs));
            };

            const saveNoteOnly = () => {
                const dateStr = formatDate(selectedDate);
                const existing = logs[dateStr];
                if (!existing) return;
                saveLog(dateStr, existing.programId, existing.status, tempNote);
            };

            const deleteLog = (dateStr) => {
                const newLogs = { ...logs };
                delete newLogs[dateStr];
                setLogs(newLogs);
                localStorage.setItem('workout_logs_mobile_v4_off', JSON.stringify(newLogs));
            };

            const exportData = () => {
                try {
                    const dataStr = JSON.stringify(logs, null, 2);
                    const blob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `workout_backup_${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showMessage("데이터 백업 파일이 다운로드되었습니다.");
                } catch (e) { showMessage("백업 오류가 발생했습니다."); }
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedLogs = JSON.parse(e.target.result);
                        if (typeof importedLogs === 'object' && importedLogs !== null) {
                            const combinedLogs = { ...logs, ...importedLogs };
                            setLogs(combinedLogs);
                            localStorage.setItem('workout_logs_mobile_v4_off', JSON.stringify(combinedLogs));
                            showMessage("데이터가 성공적으로 복구되었습니다.");
                        }
                    } catch (err) { showMessage("파일 읽기 오류입니다."); }
                };
                reader.readAsText(file);
                event.target.value = null;
            };

            const formatDate = (date) => date.toISOString().split('T')[0];
            const selectedDateStr = formatDate(selectedDate);
            const selectedLog = logs[selectedDateStr];

            const daysInMonth = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 0).getDate();
            const firstDayOfMonth = new Date(viewDate.getFullYear(), viewDate.getMonth(), 1).getDay();
            const calendarDays = [];
            for (let i = 0; i < firstDayOfMonth; i++) calendarDays.push(null);
            for (let i = 1; i <= daysInMonth; i++) calendarDays.push(new Date(viewDate.getFullYear(), viewDate.getMonth(), i));

            const memoLogs = useMemo(() => {
                return Object.entries(logs)
                    .filter(([_, data]) => data.note && data.note.trim() !== "")
                    .sort((a, b) => b[0].localeCompare(a[0]));
            }, [logs]);

            return (
                <div className="min-h-screen text-slate-100 pb-32 overflow-x-hidden selection:bg-cyan-500/30">
                    <div className="fixed inset-0 pointer-events-none -z-10">
                        <div className="absolute top-[-10%] right-[-10%] w-[80%] h-[80%] bg-blue-600/5 blur-[120px] animate-pulse-glow rounded-full"></div>
                        <div className="absolute bottom-[-10%] left-[-10%] w-[80%] h-[80%] bg-indigo-600/5 blur-[120px] animate-pulse-glow rounded-full"></div>
                    </div>

                    <div className="max-w-md mx-auto px-4 pt-6 md:max-w-6xl">
                        <header className="flex justify-between items-center mb-6 px-1">
                            <div>
                                <h1 className="text-2xl sm:text-4xl font-black italic tracking-tighter leading-tight uppercase">Limit<br/><span className="text-cyan-400">Breaker</span></h1>
                                <p className="text-[7px] font-black tracking-widest text-slate-500 uppercase">NEO-EVO System</p>
                            </div>
                            <div className="glass p-3 sm:p-4 rounded-2xl text-right min-w-[90px]">
                                <p className="text-[7px] font-black text-slate-500 uppercase mb-0.5">{viewDate.getFullYear()} Core</p>
                                <div className="text-lg sm:text-2xl font-black italic leading-none">
                                    {yearLogsCount} <span className="text-slate-600 text-[10px] font-normal">/ 300</span>
                                </div>
                                <div className="mt-1.5 h-1 w-full bg-slate-900 rounded-full overflow-hidden">
                                    <div className="h-full bg-cyan-400" style={{width: `${Math.min((yearLogsCount/300)*100, 100)}%`}}></div>
                                </div>
                            </div>
                        </header>

                        {viewMode === 'calendar' && (
                            <div className="flex flex-col gap-4">
                                <div className="glass rounded-[1.8rem] p-3 sm:p-6 shadow-xl">
                                    <div className="flex justify-between items-center mb-5 px-1">
                                        <button onClick={() => setShowNavModal(true)} className="flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-white/5 border border-white/5 text-xs sm:text-base font-black italic">
                                            {viewDate.getFullYear()} <span className="text-cyan-400">{viewDate.getMonth() + 1}월</span>
                                            <LucideIcon name="search" size={12} className="text-slate-500" />
                                        </button>
                                        <div className="flex gap-1 bg-black/40 p-0.5 rounded-lg">
                                            <button onClick={() => setViewDate(new Date(viewDate.setMonth(viewDate.getMonth() - 1)))} className="p-1.5 hover:bg-white/10 rounded-md"><LucideIcon name="chevron-left" size={16}/></button>
                                            <button onClick={() => setViewDate(new Date(viewDate.setMonth(viewDate.getMonth() + 1)))} className="p-1.5 hover:bg-white/10 rounded-md"><LucideIcon name="chevron-right" size={16}/></button>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-7 gap-1 sm:gap-2 text-center mb-2">
                                        {['S','M','T','W','T','F','S'].map((d, i) => (
                                            <div key={i} className={`text-[9px] font-black ${i===0?'text-red-500':i===6?'text-blue-500':'text-slate-600'} opacity-50`}>{d}</div>
                                        ))}
                                        {calendarDays.map((date, i) => {
                                            if (!date) return <div key={`empty-${i}`} className="aspect-square opacity-0"></div>;
                                            const dStr = formatDate(date);
                                            const log = logs[dStr];
                                            const routine = log ? ROUTINES.find(r => r.id === log.programId) : null;
                                            const completion = log ? COMPLETION_TYPES.find(t => t.id === log.status) : null;
                                            const isActive = selectedDateStr === dStr;
                                            return (
                                                <button key={dStr} onClick={() => setSelectedDate(date)} className={`calendar-cell rounded-lg sm:rounded-xl transition-all duration-200 border ${isActive ? 'bg-cyan-500 border-white shadow-md scale-105 z-10' : 'bg-white/5 border-transparent'} ${formatDate(new Date()) === dStr && !isActive ? 'bg-cyan-900/20 border-cyan-400/30' : ''}`}>
                                                    <span className={`text-xs sm:text-base font-black ${isActive ? 'text-white' : formatDate(new Date()) === dStr ? 'text-cyan-400' : 'text-slate-500'}`}>{date.getDate()}</span>
                                                    {log && (
                                                        <div className={`absolute -top-0.5 -right-0.5 p-0.5 rounded-full text-white shadow-sm ${routine.id === 'rest' ? 'bg-emerald-500' : routine.id === 'off' ? 'bg-slate-500' : (completion?.color || 'bg-slate-500')}`}>
                                                            <LucideIcon name={routine.id === 'rest' ? "trending-up" : routine.id === 'off' ? "moon" : (completion?.miniIcon || "star")} size={8} />
                                                        </div>
                                                    )}
                                                    {log && log.note && (
                                                        <div className="absolute top-0.5 left-0.5 w-1 h-1 bg-cyan-400 rounded-full"></div>
                                                    )}
                                                    {log && routine && (
                                                        <div className={`absolute bottom-0.5 w-[90%] rounded-full text-[6px] font-black text-center truncate px-0.5 ${isActive ? 'bg-white text-cyan-600 shadow-sm' : 'bg-slate-800 text-white opacity-70'}`}>{routine.label}</div>
                                                    )}
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>

                                {/* 아이콘 설명 한 줄 */}
                                <div className="flex justify-center gap-3 bg-white/5 border border-white/5 rounded-full py-2 px-3 shadow-sm no-scrollbar overflow-x-auto whitespace-nowrap">
                                    {COMPLETION_TYPES.map(t => (
                                        <div key={t.id} className="flex items-center gap-1 opacity-50">
                                            <div className={`p-0.5 rounded-full ${t.color} text-white`}><LucideIcon name={t.miniIcon} size={8} /></div>
                                            <span className="text-[7px] font-black uppercase">{t.label}</span>
                                        </div>
                                    ))}
                                    <div className="flex items-center gap-1 opacity-50">
                                        <div className="p-0.5 rounded-full bg-emerald-500 text-white"><LucideIcon name="trending-up" size={8} /></div>
                                        <span className="text-[7px] font-black uppercase tracking-tighter">EVO</span>
                                    </div>
                                    <div className="flex items-center gap-1 opacity-50">
                                        <div className="p-0.5 rounded-full bg-slate-500 text-white"><LucideIcon name="moon" size={8} /></div>
                                        <span className="text-[7px] font-black uppercase tracking-tighter">OFF</span>
                                    </div>
                                </div>

                                {/* 데일리 명언 */}
                                <div className="glass rounded-[1.5rem] p-5 relative overflow-hidden text-center group">
                                    <div className="absolute top-[-10px] left-[-10px] opacity-[0.05] text-cyan-400"><LucideIcon name="quote" size={60} /></div>
                                    <p className="text-[8px] font-black text-cyan-400 uppercase tracking-[0.3em] mb-1.5 opacity-60">Today's Pulse</p>
                                    <p className="text-sm sm:text-lg font-black italic text-slate-200 leading-tight relative z-10">"{currentQuote}"</p>
                                </div>

                                {/* 상세 기록 섹션 */}
                                <div className="glass rounded-[1.8rem] overflow-hidden shadow-2xl flex flex-col mb-4">
                                    <div className={`p-5 bg-gradient-to-br ${selectedLog ? ROUTINES.find(r => r.id === selectedLog.programId)?.color : 'from-slate-800 to-slate-900'} transition-all duration-700 relative`}>
                                        <p className="text-white/60 text-[9px] font-black mb-0.5 uppercase tracking-widest">{selectedDate.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric', weekday: 'short' })}</p>
                                        <h2 className="text-xl sm:text-2xl font-black text-white italic tracking-tighter uppercase leading-tight">{selectedLog ? ROUTINES.find(r => r.id === selectedLog.programId)?.name : "Request Command"}</h2>
                                    </div>
                                    <div className="p-5 space-y-6">
                                        <section>
                                            <div className="flex justify-between items-center mb-3 px-1">
                                                <h3 className="text-[9px] font-black text-slate-500 uppercase tracking-widest border-l-2 border-cyan-400 pl-2">ROUTINE</h3>
                                                {selectedLog && <button onClick={() => deleteLog(selectedDateStr)} className="text-[8px] font-black text-red-500/50 hover:text-red-400 underline uppercase">Delete</button>}
                                            </div>
                                            <div className="grid grid-cols-2 gap-2">
                                                {ROUTINES.map(r => (
                                                    <button key={r.id} onClick={() => saveLog(selectedDateStr, r.id, (r.id === 'rest' || r.id === 'off') ? 'full' : (selectedLog?.status || 'full'))} className={`p-3.5 rounded-xl text-left border-2 transition-all active:scale-95 ${selectedLog?.programId === r.id ? 'border-cyan-400 bg-cyan-400/10 shadow-md' : 'border-white/5 bg-white/5'}`}>
                                                        <p className={`text-[7px] font-black mb-0.5 ${selectedLog?.programId === r.id ? 'text-cyan-400' : 'text-slate-500'}`}>{r.label}</p>
                                                        <p className="text-[10px] font-black text-white uppercase truncate">{r.name}</p>
                                                    </button>
                                                ))}
                                            </div>
                                        </section>

                                        {selectedLog && (
                                            <section className="animate-in slide-in-from-top-2 duration-300">
                                                <h3 className="text-[9px] font-black text-slate-500 uppercase tracking-widest border-l-2 border-cyan-400 pl-2 mb-3">WORKOUT MEMO</h3>
                                                <textarea 
                                                    value={tempNote}
                                                    onChange={(e) => setTempNote(e.target.value)}
                                                    onBlur={saveNoteOnly}
                                                    placeholder="운동 소감을 남겨보세요..."
                                                    className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-[11px] text-slate-200 placeholder:text-slate-600 focus:outline-none focus:ring-1 ring-cyan-400 min-h-[80px] resize-none no-scrollbar"
                                                />
                                            </section>
                                        )}

                                        {selectedLog && selectedLog.programId !== 'rest' && selectedLog.programId !== 'off' && (
                                            <section className="animate-in slide-in-from-top-2 duration-300">
                                                <h3 className="text-[9px] font-black text-slate-500 uppercase tracking-widest border-l-2 border-cyan-400 pl-2 mb-3">STATUS</h3>
                                                <div className="grid grid-cols-3 gap-2">
                                                    {COMPLETION_TYPES.map(t => (
                                                        <button key={t.id} onClick={() => saveLog(selectedDateStr, selectedLog.programId, t.id)} className={`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all active:scale-95 ${selectedLog.status === t.id ? 'bg-white text-slate-950 border-white shadow-lg' : 'border-white/5 text-slate-500'}`}>
                                                            <LucideIcon name={t.icon} size={16} className="mb-1" />
                                                            <span className="text-[8px] font-black uppercase">{t.label}</span>
                                                        </button>
                                                    ))}
                                                </div>
                                            </section>
                                        )}

                                        {selectedLog?.programId === 'off' && (
                                            <div className="p-6 rounded-xl bg-slate-500/10 border border-slate-500/20 text-center flex flex-col items-center space-y-2 animate-in zoom-in">
                                                <LucideIcon name="moon" size={20} className="text-slate-400" />
                                                <h4 className="text-[10px] font-black text-slate-400 italic uppercase">System Standby</h4>
                                                <p className="text-[9px] text-slate-500 leading-tight">운동 없이 온전히 자신만의 시간을 보내는 중입니다.<br/>내일의 도전을 위해 에너지를 비축하세요.</p>
                                            </div>
                                        )}

                                        {selectedLog?.programId === 'rest' && (
                                            <div className="p-6 rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-center flex flex-col items-center space-y-2 animate-in zoom-in">
                                                <LucideIcon name="trending-up" size={20} className="text-emerald-500 animate-pulse" />
                                                <h4 className="text-[10px] font-black text-emerald-400 italic uppercase">Evolution Phase</h4>
                                                <p className="text-[9px] text-slate-400 leading-tight">성장은 휴식 중에 일어납니다.<br/>3일간의 한계를 돌파한 신체가 진화 중입니다.</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {viewMode === 'program' && (
                            <div className="flex flex-col gap-6 animate-in slide-in-from-bottom-4">
                                <div className="grid grid-cols-1 gap-3">
                                    {ROUTINES.map(r => (
                                        <div key={r.id} className="glass rounded-2xl overflow-hidden shadow-lg">
                                            <div className={`bg-gradient-to-br ${r.color} p-4 flex justify-between items-center`}>
                                                <span className="font-black text-white text-lg italic uppercase">{r.label}</span>
                                                <LucideIcon name={r.id === 'rest' ? "trending-up" : r.id === 'off' ? "moon" : "flame"} size={18} className="text-white" />
                                            </div>
                                            <div className="p-4">
                                                <h3 className="text-sm font-black text-white uppercase mb-1">{r.name}</h3>
                                                <p className="text-slate-400 text-[10px] leading-relaxed mb-3 opacity-90">{r.detail}</p>
                                                <div className="pt-2 border-t border-white/5">
                                                    <p className="text-[9px] text-slate-300 italic opacity-80 font-medium">"{r.synergy}"</p>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                <div className="glass rounded-[2rem] p-6 border-cyan-400/20">
                                    <h3 className="text-xs font-black text-cyan-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                                        <LucideIcon name="database" size={14} /> System Management
                                    </h3>
                                    <div className="grid grid-cols-1 gap-3">
                                        <button onClick={exportData} className="flex items-center justify-center gap-3 bg-cyan-600 hover:bg-cyan-500 text-white font-black py-4 rounded-2xl text-[11px] uppercase transition-all shadow-lg active:scale-95">
                                            <LucideIcon name="download" size={16} /> Download Backup
                                        </button>
                                        <button onClick={() => fileInputRef.current.click()} className="flex items-center justify-center gap-3 bg-white/10 hover:bg-white/20 text-white font-black py-4 rounded-2xl text-[11px] uppercase transition-all active:scale-95">
                                            <LucideIcon name="upload" size={16} /> Upload Backup
                                        </button>
                                        <input type="file" ref={fileInputRef} onChange={importData} accept=".json" className="hidden" />
                                    </div>
                                </div>
                            </div>
                        )}

                        {viewMode === 'memo' && (
                            <div className="flex flex-col gap-4 animate-in slide-in-from-bottom-4">
                                <h3 className="text-xs font-black text-cyan-400 uppercase tracking-widest px-1">Workout Archives</h3>
                                {memoLogs.length === 0 ? (
                                    <div className="glass rounded-[2rem] p-12 text-center opacity-30 italic text-sm">기록된 소감이 없습니다.</div>
                                ) : (
                                    memoLogs.map(([date, data]) => {
                                        const routine = ROUTINES.find(r => r.id === data.programId);
                                        return (
                                            <div key={date} className="glass rounded-3xl overflow-hidden shadow-lg border-white/5">
                                                <div className={`px-4 py-2 bg-gradient-to-r ${routine?.color || 'from-slate-800 to-slate-900'} flex justify-between items-center`}>
                                                    <span className="text-[9px] font-black italic">{date}</span>
                                                    <span className="text-[9px] font-black opacity-80 uppercase">{routine?.label} COMPLETE</span>
                                                </div>
                                                <div className="p-4 flex gap-4">
                                                    <div className="text-cyan-400 opacity-20"><LucideIcon name="quote" size={18} /></div>
                                                    <p className="text-[11px] text-slate-200 font-medium leading-relaxed italic">"{data.note}"</p>
                                                </div>
                                            </div>
                                        );
                                    })
                                )}
                            </div>
                        )}

                        <div className="fixed bottom-6 left-1/2 -translate-x-1/2 w-[85%] max-w-sm glass rounded-[1.8rem] p-1 flex gap-1 shadow-2xl z-50">
                            <button onClick={() => setViewMode('calendar')} className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-[1.5rem] text-[8px] font-black transition-all uppercase ${viewMode === 'calendar' ? 'bg-white text-slate-950 shadow-lg' : 'text-slate-500'}`}>
                                <LucideIcon name="calendar" size={14} /> CAL
                            </button>
                            <button onClick={() => setViewMode('memo')} className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-[1.5rem] text-[8px] font-black transition-all uppercase ${viewMode === 'memo' ? 'bg-white text-slate-950 shadow-lg' : 'text-slate-500'}`}>
                                <LucideIcon name="message-square" size={14} /> MEMO
                            </button>
                            <button onClick={() => setViewMode('program')} className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-[1.5rem] text-[8px] font-black transition-all uppercase ${viewMode === 'program' ? 'bg-white text-slate-950 shadow-lg' : 'text-slate-500'}`}>
                                <LucideIcon name="layout-grid" size={14} /> DB
                            </button>
                        </div>
                    </div>

                    {toast && (
                        <div className="fixed bottom-24 left-1/2 -translate-x-1/2 z-[200] glass px-6 py-3 rounded-full shadow-2xl border-cyan-400/50 animate-in fade-in slide-in-from-bottom-4">
                            <p className="text-xs font-black text-cyan-400 tracking-tight">{toast}</p>
                        </div>
                    )}

                    {showNavModal && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 backdrop-blur-3xl bg-black/80">
                            <div className="glass border-white/20 rounded-[2rem] p-6 w-full max-w-xs shadow-2xl">
                                <div className="flex justify-between items-center mb-6 text-cyan-400 font-black italic uppercase">Drive<button onClick={() => setShowNavModal(false)} className="p-1.5 bg-white/5 rounded-full"><LucideIcon name="x" size={16} /></button></div>
                                <div className="space-y-6">
                                    <select value={viewDate.getFullYear()} onChange={(e) => setViewDate(new Date(parseInt(e.target.value), viewDate.getMonth(), 1))} className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-lg text-white font-black appearance-none outline-none">
                                        {[2024, 2025, 2026, 2027].map(y => <option key={y} value={y} className="bg-slate-950">{y}</option>)}
                                    </select>
                                    <div className="grid grid-cols-4 gap-1.5">
                                        {Array.from({length: 12}).map((_, i) => (
                                            <button key={i} onClick={() => { setViewDate(new Date(viewDate.getFullYear(), i, 1)); setShowNavModal(false); }} className={`py-2 rounded-lg text-xs font-black transition-all ${viewDate.getMonth() === i ? 'bg-cyan-500 text-white shadow-md' : 'bg-white/5 text-slate-500'}`}>{i + 1}</button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>